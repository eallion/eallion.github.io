(function(a){var d=a(window),b,f,n=-1,q,m,o,s,r,h,i,A=!window.XMLHttpRequest,u=[],H=document.documentElement,e={},w=new Image,v=new Image,g,c,k,j,l,p;a(function(){a("body").append(a([g=a('<div id="lbOverlay" />').click(D)[0],c=a('<div id="lbCenter" />')[0]]).css("display","none")),k=a('<div id="lbImage" />').appendTo(c).append(j=a('<div style="position: relative;" />').append([l=a('<a id="lbPrevLink" href="#" />').click(B)[0],p=a('<a id="lbNextLink" href="#" />').click(C)[0]])[0])[0]}),a.slimbox=function(e,j,k){return b=a.extend({loop:!1,overlayOpacity:.8,overlayFadeDuration:400,resizeDuration:400,resizeEasing:"swing",initialWidth:250,initialHeight:250,imageFadeDuration:400,closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},k),typeof e=="string"&&(e=[[e,j]],j=0),r=d.scrollTop()+d.height()/2,h=b.initialWidth,i=b.initialHeight,a(c).css({top:Math.max(0,r-i/2),width:h,height:i,marginLeft:-h/2}).show(),s=A||g.currentStyle&&g.currentStyle.position!="fixed",s&&(g.style.position="absolute"),a(g).css("opacity",b.overlayOpacity).fadeIn(b.overlayFadeDuration),y(),z(1),f=e,b.loop=b.loop&&f.length>1,t(j)},a.fn.slimbox=function(e,b,c){b=b||function(a){return[a.href,a.title]},c=c||function(){return!0};var d=this;return d.unbind("click").click(function(){var h=this,i=0,g,f=0,j;g=a.grep(d,function(a,b){return c.call(h,a,b)});for(j=g.length;f<j;++f)g[f]==h&&(i=f),g[f]=b(g[f],f);return a.slimbox(g,i,e)})};function y(){var b=d.scrollLeft(),e=d.width();a([c]).css("left",b+e/2),s&&a(g).css({left:b,top:d.scrollTop(),width:e,height:d.height()})}function z(b){b?a("object").add(A?"select":"embed").each(function(b,a){u[b]=[a,a.style.visibility],a.style.visibility="hidden"}):(a.each(u,function(b,a){a[0].style.visibility=a[1]}),u=[]);var c=b?"bind":"unbind";d[c]("scroll resize",y),a(document)[c]("keydown",G)}function G(e){var c=e.which,d=a.inArray;return d(c,b.closeKeys)>=0?D():d(c,b.nextKeys)>=0?C():d(c,b.previousKeys)>=0?B():null}function B(){return t(m)}function C(){return t(o)}function t(a){return a>=0&&(n=a,q=f[n][0],m=(n||(b.loop?f.length:0))-1,o=(n+1)%f.length||(b.loop?0:-1),x(),c.className="lbLoading",e=new Image,e.onload=E,e.src=q),!1}function E(){var s,t,g,n,u;c.className="",a(k).css({backgroundImage:"url("+q+")",visibility:"hidden",display:"","background-size":"100%"}),s=e.width,t=e.height,g=d.width(),n=d.height(),s>=g||t>=n?g>=n?(a(j).width(n*.8*s/t),a([j,l,p]).height(n*.8)):(a(j).width(g*.8),a([j,l,p]).height(g*.8*t/s)):(a(j).width(e.width),a([j,l,p]).height(e.height)),m>=0&&(w.src=f[m][0]),o>=0&&(v.src=f[o][0]),h=k.offsetWidth,i=k.offsetHeight,u=Math.max(0,r-i/2),c.offsetHeight!=i&&a(c).animate({height:i,top:u},b.resizeDuration,b.resizeEasing),c.offsetWidth!=h&&a(c).animate({width:h,marginLeft:-h/2},b.resizeDuration,b.resizeEasing),a(c).queue(function(){a(k).css({display:"none",visibility:"",opacity:""}).fadeIn(b.imageFadeDuration,F)})}function F(){m>=0&&a(l).show(),o>=0&&a(p).show()}function x(){e.onload=null,e.src=w.src=v.src=q,a([c,k]).stop(!0),a([l,p,k]).hide()}function D(){return n>=0&&(x(),n=m=o=-1,a(c).hide(),a(g).stop().fadeOut(b.overlayFadeDuration,z)),!1}})(jQuery)